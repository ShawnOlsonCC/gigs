{% extends "gigs/base.html" %}
{% load thumbnail %}

{% block title %}{{ gig.artist.name }} at {{ gig.venue }} on {{ gig.date|date }}.</p>{% endblock %}
{% block content_title %}{{ gig.artist.name }}{% endblock %}
{% block body_id %}gig{% endblock %}

{% block content_intro %}
	<p>{{ gig.venue }}, {{ gig.date|date:"l jS F Y" }}.</p>
{% endblock %}

{% block content %}
	{% if gig.venue.latitude or gig.venue.town.latitude %}
		<div id="map"></div>
	{% endif %}
{% endblock %}

{% block scripts %}
	{{ block.super }}
	{% if gig.venue.latitude or gig.venue.town.latitude %}
		<script type="text/javascript" src="http://tile.cloudmade.com/wml/latest/web-maps-lite.js"></script>
		<script type="text/javascript" src="{{ MEDIA_URL }}gigs/js/map.js"></script>
		<script type="text/javascript">
			Gigs.map.init("map", "{{ MEDIA_URL}}", '{{ CLOUDMADE_API_KEY }}', {{ CLOUDMADE_STYLE_ID }});
			{% if gig.venue.latitude and gig.venue.longitude %}
				Gigs.map.show({{ gig.venue.latitude }}, {{ gig.venue.longitude }}, 16);
				Gigs.map.addMarker({{ gig.venue.latitude }}, {{ gig.venue.longitude }}, "{{ gig.venue.name }}");
			{% else %}
				{% if gig.venue.town.latitude and gig.venue.town.longitude %}
					Gigs.map.show({{ gig.venue.town.latitude }}, {{ gig.venue.town.longitude }}, 12);
				{% endif %}
			{% endif %}
		</script>
	{% endif %}
{% endblock %}
